---
title: "R"
author: "Charles Gabriel Sánchez Salas"
date: "2024-09-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Data Analysis

Librerias relevantes para el análisis: 
```{r}
library(rio)
library (ggplot2)
library(caTools)
library(DescTools)
library(dplyr)
library(Hmisc)
library(psych)
```

```{r}
url="https://raw.githubusercontent.com/d2cml-ai/CausalAI-Course/main/data/wage2015_subsample_inference.csv"
```

```{r}
wage<-read.csv(url)
```


```{r}
names(wage)
```
2. Reporte de NAs
```{r}
colSums(is.na(wage))
```
No existen datos perdidos en la base de datos

3. Reporte de estadísticas descriptivas

```{r}
describeBy(wage$wage)
```
**Interpretación** : se puede extraer información relevante si nos enfocamos en la variable del salario del individuo. Se puede observar que el salario promedio de la muestra es de 23.41 dólares.No obstante, la desviación estándar es muy alta(21), lo cual quiere decir que existe una alta dispersión del salario con respecto al promedio. Por ejemplo, existe un individuo cuyo salario es de 528.85 dólares y otro cuyo salario es de 3.02 dólares. En aras de obtener información más estable sobre el salario se recurre a la mediana, la cual nos dice que el 50% de la muestra posee un salario entre los 3.02 y 19.23 dólares. Por último, la muestra presenta una asimetría positiva, lo cual implica que existe un mayor número de trabajadores con un salario menor al promedio. 

4. Obtener el número de mujeres con un grado académico alto que poseen un salario del 25% más rico de la muestra 


4.1 Identificación de cuantiles

```{r}
summary(wage$wage)
```
4.2 Creamos una variable ordinal del salario 

```{r}
wage$wage_ordinal=cut(wage$wage, breaks = c(0,13.461,19.231,27.778,528.846),
                      include.lowest = T, ordered_result = T,
                      labels=c("Muy bajo", "Bajo", "Alto","Muy alto"))
table(wage$wage_ordinal)
```

4.3 Creamos dos subsets que solo contengan a uno de los sexos 
```{r}
wage_only_women=wage%>%filter(sex == 1)
wage_only_men= wage%>%filter(sex == 0)
```


```{r}
wage_only_women$case<- c(1)
wage_only_men$case<- c(1)
```

4.4 Agrupamos 

```{r}
wage_only_women%>%group_by(clg,wage_ordinal)%>%summarise(Casos=sum(case))
```

Existen 237 mujeres con un college dregee que poseen un salario del 25% más rico de la muestra. 

```{r}
wage_only_women%>%group_by(ad,wage_ordinal)%>%summarise(Casos=sum(case))
```
Existen 175 mujeres con un advanced degree que poseen un salario del 25% más rico de la muestra. En ambos dataframes, las mujeres que no poseen alguno de estos grados académicos tienden a ser más propensas a tener un salario del 25% menos rico de la muestra, en comparación a las mujeres que sí poseen un mayor nivel académico. Ello nos lleva a inferir que probablemente el nivel educativo puede influir en la obtención de mejores salarios. 

5. Obtener el número de hombres con un grado académico medio-bajo que poseen un salario perteneciente al 25% más rico de la muestra 

```{r}
wage_only_men%>%group_by(hsg, wage_ordinal)%>%summarise(Casos=sum(case))
```
Existen 107 trabajadores hombres con secundaria completa que poseen un salario perteneciente al 25% más rico de la muestra. 

```{r}
wage_only_men%>%group_by(shs, wage_ordinal)%>%summarise(Casos=sum(case))
```

Existen solo 8 trabajadores hombres con secundaria incompleta que tienen un salario perteneciente al 25% más rico de la muestra. Para ambos casos, los hombres que no poseen alguno de estos grados educativos son más propensos a poseer un salario pertenenciente al 25% más pobre. Si comparamos estos resultados con el anterior grupo, podemos observar que hay más mujeres con un salario altísimo en comparación con los hombres, pero ello puede deberse al mayor nivel educativo que poseen.

6. Creación de dos data frames 

```{r}
Y=wage%>%select(3)
```

```{r}
X=wage%>%select(!(2:3))
```

```{r}
X
```


